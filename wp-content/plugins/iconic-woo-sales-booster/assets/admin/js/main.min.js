jQuery(function(e){function t(){this.init=function(){e(document).on("change","#iconic-wsb-fbt-discount-type",this.selectChangeHandler),e(document).on("change","#iconic-wsb-fbt-discount-value",this.valueChangeHandler),this.selectChangeHandler()},this.selectChangeHandler=function(){var t=e("#iconic-wsb-fbt-discount-type").val(),i=e("#iconic-wsb-fbt-discount-value").val();"percentage"===t?(e("#iconic-wsb-fbt-discount-value").prop("min",0),e("#iconic-wsb-fbt-discount-value").prop("max",100),100<i&&e("#iconic-wsb-fbt-discount-value").val(100)):(e("#iconic-wsb-fbt-discount-value").prop("min",""),e("#iconic-wsb-fbt-discount-value").prop("max",""))},this.valueChangeHandler=function(){"percentage"===e("#iconic-wsb-fbt-discount-type").val()&&100<e(this).val()&&(e(this).val(100),alert("Percentage discount cannot be more than 100")),e(this).val()<0&&(e(this).val(0),alert("Discount cannot be negetive"))}}e(document).ready(function(){(new t).init()})}),jQuery(function(t){({init:function(){this.handle_export_data_btn_click()},handle_export_data_btn_click:function(){t("#wsb-export-data").on("click",function(){var e,a=t("#woocommerce-exporter-columns");a.length&&(t(this).is(":checked")?iconic_wsb_admin_vars&&iconic_wsb_admin_vars.wsb_columns_to_export&&Array.isArray(iconic_wsb_admin_vars.wsb_columns_to_export)&&(e={},iconic_wsb_admin_vars.wsb_columns_to_export.forEach(function(t){e=Object.assign(e,t)}),a.val(["id","name"]),Object.keys(e).forEach(function(t){var i;i=e[t],i=new Option(i,t,!0,!0),a.append(i)}),a.trigger("change")):a.val(null).trigger("change"))})}}).init()}),jQuery(function(t){var i,e,a,n,s;"undefined"!=typeof iconic_wsb_admin_vars&&void 0!==iconic_wsb_admin_vars.postId&&(e=wp.media.model.settings.post.id,a=iconic_wsb_admin_vars.postId,n=t("[data-iconic-wsb-image-preview]"),s=t("[data-iconic-wsb-image-attachment-id]"),t(document).on("click","[data-iconic-wsb-upload-image]",function(t){t.preventDefault(),i?i.uploader.uploader.param("post_id",a):(wp.media.model.settings.post.id=a,(i=wp.media.frames.file_frame=wp.media({title:"Select a image to upload",button:{text:"Use this image"},multiple:!1})).on("select",function(){var t=i.state().get("selection").first().toJSON();n.attr("src",t.url),s.val(t.id),wp.media.model.settings.post.id=e})),i.open()}),t("a.add_media").on("click",function(){wp.media.model.settings.post.id=e}))}),jQuery(function(d){"undefined"!=typeof iconic_wsb_admin_vars&&void 0!==iconic_wsb_admin_vars.postId&&(d("[data-iconic-wsb-color-picker]").wpColorPicker({change:function(t,i){i=i.color.toString();d(this).val(i).trigger("change")}}),d(document).on("change","[data-iconic-wsb-display-for--select]",function(){var t=d(this),i=t.closest("[data-iconic-wsb-display-for--scope]"),e=i.find("[data-iconic-wsb-display-for--spoiler]"),a=i.find("[data-iconic-wsb-display-for--control]"),n=i.find("[data-iconic-wsb-display-for--categories]"),s=i.find("[data-iconic-wsb-display-for--category-control]"),i=i.find("[data-iconic-wsb-display-for--spoiler][data-iconic-wsb-display-for--categories]");"specific"!==t.val()?(e.addClass("iconic-wsb-hidden"),a.removeAttr("required")):(e.removeClass("iconic-wsb-hidden"),a.attr("required","required")),"categories"!==t.val()?(n.addClass("iconic-wsb-hidden"),s.removeAttr("required")):(n.removeClass("iconic-wsb-hidden"),s.attr("required","required")),"categories"===t.val()||"specific"===t.val()?i.removeClass("iconic-wsb-hidden"):i.addClass("iconic-wsb-hidden")}),d(document).on("change","[data-iconic-wsb-specific-products]",function(){var t=d(this).val(),i=d("[data-iconic-wsb-offer-product]");!d("[iconic_wsb_enable_bump_for_same_product]:checked")&&t&&t.length&&i.data("exclude",t.join(","))}),d(document).on("change","[data-iconic-wsb-offer-product]",function(){var t=d(this).val(),a=d("[data-iconic-wsb-discount-value]"),n=d("[data-iconic-wsb-discount-type]").val(),s=d("[data-iconic-wsb-image-preview]"),c=d("[data-iconic-wsb-image-attachment-id]"),o=d(this);d.get(ajaxurl,{action:"iconic_wsb_checkout_order_bump_calculate_price",product_id:t},function(t){var i=o.closest("[data-iconic-wsb-offer-scope]"),e=i.find("[data-iconic-wsb-discount-type]"),i=i.find("[data-iconic-wsb-discount-value]");e.attr("data-simple-max",t.sale_price),"simple"===n&&i.attr("max",t.sale_price),"percentage"===n&&i.attr("max",e.attr("data-percentage-max")),t.image_id&&(s.attr("src",t.image_url),c.val(t.image_id)),a.trigger("input")})}),d(document).on("change","[data-iconic-wsb-discount-type]",function(){var t=d(this),i=t.closest("[data-iconic-wsb-offer-scope]").find("[data-iconic-wsb-discount-value]");"percentage"===t.val()?(i.attr("max",t.attr("data-percentage-max")),99<i.val()&&i.val(1)):"simple"===t.val()&&i.attr("max",t.attr("data-simple-max")),i.trigger("input")}),d(document).on("change","[data-iconic-wsb-discount-value],[data-iconic-wsb-discount-type],[data-iconic-wsb-offer-product]",function(){var t=d("[data-iconic-wsb-discount-value]").val(),i=d("[data-iconic-wsb-discount-type]").val(),e=d("[data-iconic-wsb-offer-product]").val(),a=d("[data-iconic-wsb-setting-show-price--element]"),n=d("[data-iconic-wsb-product-customize-price--regular]");a.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),d.get(ajaxurl,{action:"iconic_wsb_checkout_order_bump_calculate_price",product_id:e,discount_type:i,discount:t},function(t){n.html(t.regular_price_html),d("[data-iconic-wsb-product-customize-price--discount]").html(t.sale_price_html),parseFloat(t.regular_price)===parseFloat(t.sale_price)?n.addClass("hidden"):n.removeClass("hidden"),a.unblock()})}),d(document).on("change","[data-iconic-wsb-setting-show-image]",function(){var t=d("[data-iconic-wsb-setting-show-image--element]");"yes"===d(this).val()?t.removeClass("iconic-wsb-hidden"):t.addClass("iconic-wsb-hidden")}),d(document).on("change","[data-iconic-wsb-setting-show-price]",function(){var t=d("[data-iconic-wsb-setting-show-price--element]");"yes"===d(this).val()?t.removeClass("iconic-wsb-hidden"):t.addClass("iconic-wsb-hidden")}),d(document).on("change","[data-iconic-wsb-setting-border-style]",function(){var t=d(this).val();d("[data-iconic-wsb-setting-border-style--element]").css({"border-style":t})}),d(document).on("change","[data-iconic-wsb-setting-border-color]",function(){var t=d(this).val();d("[data-iconic-wsb-setting-border-style--element]").css({"border-color":t})}),d(document).on("change","[data-iconic-wsb-setting-highlight-color]",function(){var t=d(this).val();d("[data-iconic-wsb-setting-highlight-color--element]").css({color:t})}),d(document).on("change","[data-iconic-wsb-setting-show-shadow]",function(){"yes"===d(this).val()?d("[data-iconic-wsb-setting-border-style--element]").css("box-shadow",""):d("[data-iconic-wsb-setting-border-style--element]").css("box-shadow","none")}),d(document).on("click","[data-add-benefit-button]",function(t){t.preventDefault();t=d("[data-benefit-template]").clone();t.removeAttr("data-benefit-template"),t.removeClass("iconic-wsb-hidden"),d("[data-benefits-container]").append(t)}),d(document).on("click","[data-remove-benefit]",function(){d(this).closest("[data-benefit]").remove()}),d(document).on("click",".iconic-wsb-edit-page-nav__item-link",function(t){t.preventDefault();var t=d(this),i=d(".iconic-wsb-edit-page-nav__item-link"),e=t.attr("href"),a=d(".iconic-wsb-edit-page__step"),e=d(e);i.removeClass("iconic-wsb-edit-page-nav__item-link--active"),t.addClass("iconic-wsb-edit-page-nav__item-link--active"),a.removeClass("iconic-wsb-edit-page__step--active"),e.addClass("iconic-wsb-edit-page__step--active")}))}),jQuery(function(a){"undefined"==typeof iconic_wsb_admin_vars||void 0===iconic_wsb_admin_vars.posts||0===a(".post_type_page").length||"at_checkout_ob"!==a(".post_type_page").val()&&"after_checkout_ob"!==a(".post_type_page").val()||a("#the-list").sortable({handle:".iconic-wsb-sortable",axis:"y",update:function(t,i){var e=a(".wp-list-table");a.ajax({type:"POST",url:ajaxurl,data:{data:a(this).sortable("serialize"),posts:iconic_wsb_admin_vars.posts,action:"iconic_wsb_handle_sorting_bump_checkout_product",post_type:iconic_wsb_admin_vars.post_type},success:function(t){iconic_wsb_admin_vars.posts=t.posts},beforeSend:function(){e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}})},complete:function(){e.unblock()},dataType:"json"})}})}),((o,t)=>{var e="inputQuantity",a={input:"[data-quantity-field]",checkNotNumberReg:/[\D]/g,checkNotNumberFloatReg:/[^\d\.]/g,decimalSeparatorReg:/[.]/g,tooltipTimeout:3e3};function i(t,i){this.element=t,this.settings=o.extend({},a,i),this.settings.validationMessage=o(this.element).data("quantity-validation"),this._defaults=a,this._name=e,this.init()}o.extend(i.prototype,{init:function(){this.input=o(this.element).find(this.settings.input),o(this.input).on("input",o.proxy(this.inputHandler,this)),o(this.input).on("keypress",o.proxy(this.keypressHandler,this)),this.tooltip=o("<div/>",{class:"iconic-wsb-quantity__tooltip",text:""}).appendTo(o(this.element));var t=o(this.input).attr("step"),t=String(t).substring(String(t).indexOf(".")).length-1;this.settings.float=0!=t},keypressHandler:function(t){t=t||event;var i=this.getChar(t),e=this.settings.validationMessage.onlyNumber,a=this.settings.decimalSeparatorReg,n=o(this.input).val(),s=this.settings.float?this.settings.checkNotNumberFloatReg:this.settings.checkNotNumberReg;return t.ctrlKey||t.altKey||null==i||s.test(i)||n.match(a)&&!/[\d]/.test(i)?(this.showMessage(e),!1):void 0},inputHandler:function(t){var i=o(this.input).val();return this.validateInput(i)},validateInput:function(t){var i=o(this.input),e=Number(i.attr("max"))||1/0,i=Number(i.attr("min"))||-1/0,a=this.settings.validationMessage.max,n=this.settings.validationMessage.min,s=this.settings.validationMessage.onlyNumber,c=this.settings.float?this.settings.checkNotNumberFloatReg:this.settings.checkNotNumberReg;return e<t?(this.showMessage(a+e),this.setInputValue(e)):t<i?(this.showMessage(n+i),this.setInputValue(i)):isNaN(t)||c.test(t)?(this.showMessage(s),this.setInputValue(i)):this.setInputValue(t)},setInputValue:function(t){var i=o(this.input),e=i.attr("step"),e=String(e).substring(String(e).indexOf(".")).length-1;return Number(t)!==+Number(t).toFixed(0)&&(t=Number(t).toFixed(e)),i.val(t),t},showMessage:function(t){var i=this,e=this.settings.tooltipTimeout;o(this.tooltip).html(t).addClass("is-active"),clearTimeout(this.timerId),this.timerId=setTimeout(function(){i.removeMessage()},e)},removeMessage:function(){o(this.tooltip).removeClass("is-active")},getChar:function(t){return null===t.which?t.keyCode<32?null:String.fromCharCode(t.keyCode):0===t.which||0===t.charCode||t.which<32?null:String.fromCharCode(t.which)}}),o.fn[e]=function(t){return this.each(function(){o.data(this,"plugin_"+e)||o.data(this,"plugin_"+e,new i(this,t))})},o(t).ready(function(){o("[data-quantity-validation]").inputQuantity()})})(jQuery,(window,document));