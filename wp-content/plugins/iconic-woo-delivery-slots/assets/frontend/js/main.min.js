(s=>{const e=function(){wp.hooks.addFilter("iconic_wds_is_checkout","iconic_wds",function(e){return!!s("body").hasClass("checkout-wc")||e})},t=function(){s("body").on("viwcaio_sc_effect_after_atc",function(){window.jckwds.cache(),window.jckwds.toggle_date_time_fields()}),wp.hooks.addFilter("iconic_wds_is_checkout","iconic_wds",function(e){return 0<s("body").find(".vi-wcaio-checkout-step-wrap").length||e})},d=function(){jQuery("a[href^='"+CSS.escape("#elementor-action%3Aaction%3Dpopup%3Aopen")+"']").click(function(){setTimeout(function(){jQuery(document.body).trigger("iconic_wds_init_reservation_table")},100)})};s(document).ready(e),s(document).ready(t),s(document).ready(d)})(jQuery),((a,d)=>{window.jckwds={cache(){jckwds.els={},jckwds.els.document=a(d),jckwds.els.document_body=a(d.body),jckwds.els.date_picker=a("#jckwds-delivery-date"),jckwds.els.date_ymd=a("#jckwds-delivery-date-ymd"),jckwds.els.timeslot_select=a("#jckwds-delivery-time"),jckwds.els.timeslot_select_wrapper=a("#jckwds-delivery-time-wrapper"),jckwds.els.timeslot_field_row=a("#jckwds-delivery-time_field"),jckwds.els.checkout_fields=a("#jckwds-fields"),jckwds.els.fields_hidden=a('[name="iconic-wds-fields-hidden"]'),jckwds.els.ship_to_different_address_checkbox=a("#ship-to-different-address-checkbox"),jckwds.els.shipping_postcode_field=a("#shipping_postcode"),jckwds.els.billing_postcode_field=a("#billing_postcode"),jckwds.els.multi_step_checkout=a("#wizard")},common_vars(){jckwds.vars={},jckwds.vars.is_checkout=wp.hooks.applyFilters("iconic_wds_is_checkout",jckwds.els.document_body.hasClass("woocommerce-checkout")),jckwds.vars.is_order_view=jckwds.els.document_body.hasClass("woocommerce-view-order"),jckwds.vars.has_multi_step=0<jckwds.els.multi_step_checkout.length,jckwds.vars.inactive_class="jckwds-fields-inactive",jckwds.vars.chosen_shipping_method=!1,jckwds.vars.set_date_flag=!1,jckwds.vars.wds_ajax_init_flag=!1,jckwds.vars.is_order_pay=jckwds.els.document_body.hasClass("woocommerce-order-pay"),jckwds.vars.is_order_page=a("#jckwds-fields-order-id").length,jckwds.vars.order_id=a("#jckwds-fields-order-id").val()},on_load(){jckwds.cache(),jckwds.common_vars(),jckwds.setup_checkout(),jckwds.setup_multi_step_checkout(),a(jckwds.els.document_body).trigger("iconic_wds_init_tooltip")},setup_checkout(){!jckwds.vars.is_checkout&&!jckwds.vars.is_order_view||jckwds.vars.has_multi_step||jckwds.vars.is_order_pay||(jckwds.setup_checkout_fields(),jckwds.watch_update_checkout())},setup_multi_step_checkout(){a(d.body).on("cfw_updated_checkout",function(){jckwds.cache(),jckwds.unblock_checkout(),jckwds.setup_date_picker()}),jckwds.vars.is_checkout&&jckwds.vars.has_multi_step&&jckwds.els.multi_step_checkout.init(function(){jckwds.cache(),jckwds.common_vars(),jckwds.setup_checkout_fields(),jckwds.watch_update_checkout()})},setup_checkout_fields(){jckwds.setup_date_picker(),jckwds.setup_timeslot_select()},setup_date_picker(){a("#jckwds-delivery-date").hasClass("hasDatepicker")?jckwds.maybe_auto_select_first_date():(jckwds.els.date_picker.datepicker({defaultDate:jckwds_vars.bookable_dates[0],minDate:jckwds_vars.bookable_dates[0],maxDate:jckwds_vars.bookable_dates[jckwds_vars.bookable_dates.length-1],beforeShow(e,s){var t=0<=a.inArray(jckwds_vars.settings.datesettings_datesettings_setup_uitheme,["none","dark","light"])?jckwds_vars.settings.datesettings_datesettings_setup_uitheme:"dark";s.dpDiv.addClass("iconic-wds-datepicker iconic-wds-datepicker--"+t),jckwds.els.document_body.trigger("iconic_wds_datepicker_before_show",s)},beforeShowDay(e){let s=a.datepicker.formatDate(jckwds_vars.settings.datesettings_datesettings_dateformat,e,{monthNames:jckwds_vars.strings.months,monthNamesShort:jckwds_vars.strings.months_short,dayNames:jckwds_vars.strings.days,dayNamesShort:jckwds_vars.strings.days_short,dayNamesMin:jckwds_vars.strings.days_short}).toString(),t="iconic-wds-date";var d;return jckwds.within_min_max_range(s)&&(t+=" iconic-wds-date--tooltip"),jckwds.is_date_available(s)?(e=jckwds.get_fee_for_date(e),(d=parseFloat(e.replace(jckwds_vars.currency.symbol,"")))&&(t+=" iconic-wds-date--fee"),[!0,t,d?"+"+e:""]):[!1,t,jckwds_vars.strings.unavailable]},dateFormat:jckwds_vars.settings.datesettings_datesettings_dateformat,onSelect(e,s){a(this).trigger("change"),""!==this.value&&(s=[jckwds.pad_left(s.selectedYear,4),jckwds.pad_left(s.selectedMonth+1,2),jckwds.pad_left(s.selectedDay,2)].join(""),jckwds.els.date_ymd.val(s),jckwds.vars.set_date_flag?jckwds.vars.set_date_flag=!1:jckwds.is_true(jckwds_vars.settings.timesettings_timesettings_setup_enable)?jckwds.update_timeslot_options(s):jckwds.els.document_body.trigger("update_checkout"))},onChangeMonthYear(){jckwds.els.document_body.trigger("iconic_wds_datepicker_on_change_month_year")},monthNames:jckwds_vars.strings.months,monthNamesShort:jckwds_vars.strings.months_short,dayNames:jckwds_vars.strings.days,dayNamesShort:jckwds_vars.strings.days_short,dayNamesMin:jckwds_vars.strings.days_short,firstDay:jckwds.get_first_day_of_the_week(),duration:0}),a.datepicker.setDefaults(a.datepicker.regional[""]),jckwds.els.date_picker.datepicker(a.datepicker.regional[""]),jckwds.maybe_auto_select_first_date(),a(".ui-datepicker").addClass("notranslate"))},maybe_auto_select_first_date(){"1"!==jckwds_vars.settings.datesettings_datesettings_setup_auto_select_first||!jckwds_vars.bookable_dates.length||jckwds.els.checkout_fields.hasClass(jckwds.vars.inactive_class)||jckwds.els.date_ymd.val()||jckwds.set_date(jckwds_vars.bookable_dates[0],!0)},is_true(e){return!(!e||0===e||"0"===e||""===e||e.length<=0)},get_fee_for_date(e){let s=e.getDay(),t=a.datepicker.formatDate(jckwds_vars.settings.datesettings_datesettings_dateformat,e,{monthNames:jckwds_vars.strings.months,monthNamesShort:jckwds_vars.strings.months_short,dayNames:jckwds_vars.strings.days,dayNamesShort:jckwds_vars.strings.days_short,dayNamesMin:jckwds_vars.strings.days_short}).toString(),d=t.replace(/\//g,""),i=void 0!==jckwds_vars.day_fees[d]?parseFloat(jckwds_vars.day_fees[d]):parseFloat(jckwds_vars.day_fees[s]);return t===jckwds_vars.dates.same_day&&0<jckwds_vars.settings.datesettings_fees_same_day.length&&(i+=parseFloat(jckwds_vars.settings.datesettings_fees_same_day)),t===jckwds_vars.dates.next_day&&0<jckwds_vars.settings.datesettings_fees_next_day.length&&(i+=parseFloat(jckwds_vars.settings.datesettings_fees_next_day)),!isNaN(i)&&accounting.formatMoney(i,jckwds_vars.currency)},set_date(e,s){e&&(e.length<=0||!jckwds.is_date_available(e,!1)?(jckwds.els.date_picker.blur().datepicker("hide").datepicker("setDate",null),jckwds.els.date_ymd.val(""),jckwds.clear_timeslots(jckwds_vars.strings.selectdate_first)):(s=void 0!==s&&s,jckwds.vars.set_date_flag=!s,e=a.datepicker.parseDate(jckwds_vars.settings.datesettings_datesettings_dateformat,e,{monthNames:jckwds_vars.strings.months,monthNamesShort:jckwds_vars.strings.months_short,dayNames:jckwds_vars.strings.days,dayNamesShort:jckwds_vars.strings.days_short,dayNamesMin:jckwds_vars.strings.days_short}),jckwds.els.date_picker.blur().datepicker("hide").datepicker("setDate",e),a(".ui-datepicker .ui-state-active").click()))},is_date_available(t){if(jckwds_vars.bookable_dates.length<=0)return!1;let d=!1;return t=t.toLowerCase(),a.each(jckwds_vars.bookable_dates,function(e,s){if(!1===d&&s.toLowerCase()===t)return!(d=!0)}),d},update_timeslot_options(e,s){let t=jckwds.els.timeslot_select.find("option:eq(0)"),d=jckwds.els.timeslot_select.val(),i=(jckwds.els.ship_to_different_address_checkbox.is(":checked")?a("#shipping_postcode"):a("#billing_postcode")).val();jckwds.clear_timeslots(jckwds_vars.strings.loading),jckwds.els.timeslot_select.attr("disabled","disabled").trigger("change",["update_timeslots"]);e={action:"iconic_wds_get_slots_on_date",nonce:jckwds_vars.ajax_nonce,date:e,postcode:i};jckwds.vars.is_order_page&&jckwds.vars.order_id&&(e.order_id=jckwds.vars.order_id),jQuery.post(jckwds_vars.ajax_url,e,function(e){!0===e.success?(jckwds.clear_timeslots(jckwds_vars.strings.selectslot),jckwds.els.timeslot_select.append(e.html),d=0<jckwds.els.timeslot_select.find('option[value="'+d+'"]').length?d:0,e.reservation?0<jckwds.els.timeslot_select.find("option[value='"+e.reservation+"']").length&&jckwds.els.timeslot_select.val(e.reservation):0!==d&&""!==d?jckwds.els.timeslot_select.val(d):"1"===jckwds_vars.settings.timesettings_timesettings_setup_auto_select_first?jckwds.els.timeslot_select.val(jckwds.els.timeslot_select.find("option:eq(1)").val()):jckwds.els.timeslot_select.val(jckwds.els.timeslot_select.find("option:eq(0)").val()),jckwds.els.document_body.trigger("update_checkout")):t.text(jckwds_vars.strings.noslots),jckwds.els.document_body.trigger("timeslots_loaded"),jckwds.els.timeslot_select.removeAttr("disabled").trigger("change",["update_timeslots"]),void 0!==s&&s(e)})},refresh_timeslots(e){e=void 0!==e&&e,jckwds.els.timeslot_field_row.hasClass("jckwds-delivery-time--has-reservation")&&!1===e?jckwds.els.timeslot_field_row.removeClass("jckwds-delivery-time--has-reservation"):(e=jckwds.els.date_ymd.val(),jckwds.is_true(e)&&jckwds.is_true(jckwds_vars.settings.timesettings_timesettings_setup_enable)&&jckwds.update_timeslot_options(e),jckwds.els.document_body.trigger("timeslots_refreshed"))},clear_date(){jckwds.els.date_ymd.val(""),jckwds.set_date("")},clear_timeslots(e){jckwds.els.timeslot_select.children().not(":first").remove(),"string"==typeof e&&jckwds.els.timeslot_select.find("option:eq(0)").text(e)},setup_timeslot_select(){jckwds.els.timeslot_select.on("change",function(e,s){"update_timeslots"===(s=void 0!==s&&s)?window.setTimeout(function(){jckwds.els.timeslot_select.closest(".form-row").removeClass("woocommerce-invalid")},10):jckwds.els.document_body.trigger("update_checkout")})},watch_update_checkout(){jckwds.els.document_body.on("update_checkout",function(e){jckwds.vars.is_order_page||jckwds.vars.is_order_view||jckwds.block_checkout()}),jckwds.els.document_body.on("updated_checkout",function(e,s){var t;s&&s.fragments&&s.fragments.iconic_wds&&(jckwds.cache(),jckwds.setup_date_picker(),jQuery.fn.select2&&a("#jckwds-delivery-time").hasClass("select2-hidden-accessible")&&(jQuery("#jckwds-delivery-time").select2("destroy"),jQuery("#jckwds-delivery-time").select2()),jckwds.update_checkout_field_labels(s.fragments.iconic_wds.labels),s.fragments.iconic_wds.chosen_shipping_method===jckwds.vars.chosen_shipping_method?(s.fragments.iconic_wds&&s.fragments.iconic_wds.slots_allowed&&!jckwds.vars.wds_ajax_init_flag&&(jckwds.vars.wds_ajax_init_flag=!0,jckwds.cache(),jckwds.show_date_time_fields()),jckwds.unblock_checkout()):(jckwds.vars.chosen_shipping_method=s.fragments.iconic_wds.chosen_shipping_method.toString(),jckwds.toggle_date_time_fields(s.fragments.iconic_wds,function(e){e&&jckwds.refresh_datepicker(s.fragments.iconic_wds.bookable_dates,function(){jckwds.refresh_timeslots(!0)}),jckwds.unblock_checkout()}),t=a("form.checkout [name=woocommerce_checkout_place_order]"),0===s.fragments.iconic_wds.bookable_dates.length?(jckwds.els.checkout_fields.addClass("iconic-wds-fields--has-error"),t.prop("disabled",!0),a("#ppc-button").hide()):(jckwds.els.checkout_fields.removeClass("iconic-wds-fields--has-error"),t.prop("disabled",!1),a("#ppc-button").show())))}),jckwds.els.checkout_fields.hasClass(jckwds.vars.inactive_class)&&jckwds.hide_date_time_fields()},block_checkout(){jckwds.els.checkout_fields.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),a("#place_order").attr("disabled","disabled")},unblock_checkout(){jckwds.els.checkout_fields.unblock({fadeOut:0}),a("#place_order").removeAttr("disabled")},update_checkout_field_labels(e){if(!(e.length<=0)){let d={details:a(".iconic-wds-fields__title"),date:a(".jckwds-delivery-date label"),select_date:a("#jckwds-delivery-date"),choose_date:a("#jckwds-delivery-date-description"),time_slot:a(".jckwds-delivery-time label"),choose_time_slot:a(" #jckwds-delivery-time-description")};a.each(e,function(e,s){var t;return void 0===d[e]||(d[e].is("input")?(d[e].attr("placeholder",s),!0):(t=d[e].find("*"),d[e].text(s),void(0<t.length&&d[e].append("&nbsp;").append(t))))})}},refresh_datepicker(e,s){jckwds_vars.bookable_dates=e,jckwds.els.date_picker.blur().datepicker("hide").datepicker("option","defaultDate",e[0]).datepicker("option","minDate",e[0]).datepicker("option","maxDate",e[e.length-1]),jckwds.maybe_auto_select_first_date(),jckwds_vars.reserved_slot&&jckwds_vars.reserved_slot.date?-1!==a.inArray(jckwds_vars.reserved_slot.date.formatted,jckwds_vars.bookable_dates)&&jckwds.set_date(jckwds_vars.reserved_slot.date.formatted):(e=jckwds.els.date_picker.val(),jckwds.set_date(e)),void 0!==s&&s()},clear_date_time_fields(){jckwds.clear_date(),jckwds.clear_timeslots()},toggle_date_time_fields(e,s){jckwds.should_hide_date_time_fields()?(jckwds.hide_date_time_fields(),"function"==typeof s&&s(!1,{index:!0})):(jckwds.show_date_time_fields(),e.slots_allowed?jckwds.show_date_time_fields():jckwds.hide_date_time_fields(),"function"==typeof s&&s(e.slots_allowed))},should_hide_date_time_fields(){return!(0<=a.inArray("any",jckwds_vars.settings.general_setup_shipping_methods)||jckwds_vars.all_products_virtual&&jckwds_vars.settings.general_setup_display_for_virtual&&0<=a.inArray("any_virtual",jckwds_vars.settings.general_setup_shipping_methods)||jckwds_vars.needs_shipping&&0<=a.inArray(jckwds.vars.chosen_shipping_method,jckwds_vars.settings.general_setup_shipping_methods))},hide_date_time_fields(){jckwds.els.checkout_fields.removeClass("woocommerce-billing-fields").hide(),jckwds.els.fields_hidden.val(1),jckwds.clear_date_time_fields()},show_date_time_fields(){jckwds.els.checkout_fields.addClass("woocommerce-billing-fields").removeClass(jckwds.vars.inactive_class).show(),jckwds.els.fields_hidden.val(0)},get_last_day_of_the_week(){var e={monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6,sunday:0};return void 0===jckwds_vars.settings.datesettings_datesettings_last_day_of_week||void 0===e[jckwds_vars.settings.datesettings_datesettings_last_day_of_week]?6:e[jckwds_vars.settings.datesettings_datesettings_last_day_of_week]},get_first_day_of_the_week(){var e=jckwds.get_last_day_of_the_week();return 6===e?0:e+1},pad_left(e,s,t){return new Array(s-String(e).length+1).join(t||"0")+e},checkout_error(){var e=a('[data-iconic-wds-clear-date="1"]'),s=a('[data-iconic-wds-clear-time="1"]'),t=a('[data-iconic-wds-update-checkout="1"]');e.length<=0&&s.length<=0&&t.length<=0||(0<e.length&&jckwds.clear_date(),0<s.length&&jckwds.refresh_timeslots(!0),0<t.length&&a(d.body).trigger("update_checkout"))},submit_error(e){var s=a("form.checkout");a(".woocommerce-NoticeGroup-checkout, .woocommerce-error, .woocommerce-message").remove(),s.prepend('<div class="woocommerce-NoticeGroup woocommerce-NoticeGroup-checkout">'+e+"</div>"),s.removeClass("processing").unblock(),s.find(".input-text, select, input:checkbox").trigger("validate").blur(),a(d.body).trigger("checkout_error",[e])},within_min_max_range(e){return jckwds_vars.bookable_dates.includes(e)}},a(window).on("load",jckwds.on_load),a(d.body).on("checkout_error",jckwds.checkout_error)})(jQuery,document),jQuery(function(){if(window.Vue&&window.vueConciseSlider){let t=new Vue;function e(){jQuery(".wds-reservation-table-wrapper").length&&(jQuery(".wds-reservation-table-wrapper").html(jQuery("#wds-reservation-table-script").html()),window.iconic_wds_reservation_table=new Vue({el:"#wds-reservation-table",data:{page_loaded:!1,formatted_timeslot_seperator:"@",shipping_methods:[],selected_shipping_method:"",available_timeslots:{},available_dates:[],selected_date:"",selected_date_timeslots:[],selected_slot:"",shipping_method_type:jckwds_vars.strings.reservation_table.delivery,datetime_required_for_selected_method:!0,shipping_method_provided_as_shortcode_arg:!1,address:{country:"",state:"",city:"",postcode:""},timeslot_enabled:!1,remaining_label_threshold:!1,step1:{caption:"",form_open:!1,data_available:!0,none_caption:jckwds_vars.strings.reservation_table.none_selected},step2:{caption:"",form_open:!1,data_available:!1,none_caption:jckwds_vars.strings.reservation_table.none_selected},step3:{caption:"",form_open:!1,data_available:!1,none_caption:jckwds_vars.strings.reservation_table.none_selected},strings:{free:jckwds_vars.strings.reservation_table.free}},mounted(){this.page_loaded=!0,this.timeslot_enabled="1"===jckwds_vars.settings.timesettings_timesettings_setup_enable,this.remaining_label_threshold=parseInt(jckwds_vars.settings.reservations_reservations_remaining_label_threshold),jckwds_vars.shipping&&(this.shipping_methods=jckwds_vars.shipping.shipping_methods,this.step1.caption=jckwds_vars.shipping.formatted_destination,this.selected_shipping_method=jckwds_vars.shipping.selected_shipping_method),($parent=jQuery(this.$el).parent()).data("shipping-method")&&(this.shipping_method_provided_as_shortcode_arg=$parent.data("shipping-method"),this.selected_shipping_method=$parent.data("shipping-method")),this.selected_shipping_method&&(this.step3.form_open=!0,this.selected_date=jckwds_vars?.reserved_slot?.date?.id?jckwds_vars.reserved_slot.date.id:"",Vue.nextTick(()=>{jckwds_vars.reserved_slot.id?(this.selected_slot=jckwds_vars.reserved_slot.id,this.fetch_dates(this.selected_date,!1)):this.fetch_dates(),this.step3.caption=jckwds_vars.reserved_slot.string}))},methods:{open_form(e){var s=this["step"+e];s.form_open=!s.form_open,3===e&&0===this.available_dates.length&&this.fetch_dates(),s.form_open&&t.$emit("open_step",e)},btn_text(e){e=this["step"+e];return e.form_open?window.jckwds_vars.strings.reservation_table.cancel:""===e.caption?window.jckwds_vars.strings.reservation_table.add:window.jckwds_vars.strings.reservation_table.edit},has_grey_bg(e){e=this["step"+e];return!e.form_open&&""===e.caption},fetch_shipping_methods(){var e={action:"iconic_wds_get_address_shipping_methods",calc_shipping_country:this.address.country,calc_shipping_state:this.address.state,calc_shipping_city:this.address.city,calc_shipping_postcode:this.address.postcode,nonce:window.jckwds_vars.ajax_nonce};let s=this;s.block(),jQuery.post(window.jckwds_vars.ajax_url,e,function(e){e.success?(s.open_step(2),s.shipping_methods=e.data.shipping_methods,s.step1.caption=e.data.formatted_destination,s.selected_shipping_method="",s.available_dates=[],s.available_timeslots={},e.data.new_nonce&&(window.jckwds_vars.ajax_nonce=e.data.new_nonce),1===(e=Object.keys(s.shipping_methods)).length&&(s.selected_shipping_method=e[0],Vue.nextTick(()=>{s.fetch_dates()}))):alert(jckwds_vars.strings.reservation_table.no_shiping_methods)}).always(function(){s.unblock()})},handle_fetch_dates_button_click(){this.available_dates=[],this.available_timeslots={},this.selected_date_timeslots=[],this.fetch_dates(null,!0,!0)},fetch_dates(t,d,i){var e={action:"iconic_wds_get_reservation_table_data",shipping_method:this.selected_shipping_method,nonce:window.jckwds_vars.ajax_nonce};"string"==typeof t&&(e.ymd=t),void 0===d&&(d=!0);let a=this;a.block(),jQuery.post(window.jckwds_vars.ajax_url,e,function(e){if(e.success)if(a.available_dates=e.data.dates,!1===e.data.datetime_required_for_selected_method)a.step3.caption=e.data.message,a.step3.form_open=!1,a.step2.form_open=!1,a.datetime_required_for_selected_method=!1;else if(a.datetime_required_for_selected_method=!0,a.available_dates&&0!==a.available_dates.length){for(var s in d?a.open_step(3):a.open_step(-1),e.data.timeslots)a.$set(a.available_timeslots,s,e.data.timeslots[s]);"string"==typeof t&&(a.selected_date_timeslots=a.available_timeslots[a.selected_date]),a.shipping_method_type=e.data.shipping_method_type,a.selected_date&&a.available_timeslots[a.selected_date]&&(a.selected_date_timeslots=a.available_timeslots[a.selected_date]),i&&Vue.nextTick(function(){jQuery("html, body").animate({scrollTop:jQuery(".wds-reservation-table__step--datetime").offset().top-50},600)}),jQuery(document.body).trigger("iconic_wds_reservation_table_dates_fetched",[t,d])}else alert(e.data.message)}).always(function(){a.unblock()})},handle_select_date(e){void 0===this.available_timeslots[e.ymd]&&this.fetch_dates(e.ymd),this.selected_slot=null,this.selected_date_timeslots=this.available_timeslots[e.ymd],this.selected_date=e.ymd},select_slot(e){0<e.slots_available_count&&(this.selected_slot=e.slot_id)},reserve_slot(){var e={action:"iconic_wds_reserve_slot",nonce:window.jckwds_vars.ajax_nonce,timeslot_enabled:this.timeslot_enabled,slot_id:this.timeslot_enabled?this.selected_timeslot_obj.slot_id:"",slot_start_time:this.timeslot_enabled?this.selected_timeslot_obj.timefrom.stripped:"",slot_end_time:this.timeslot_enabled?this.selected_timeslot_obj.timeto.stripped:"",slot_date:this.selected_date};let s=this;s.block(),jQuery.post(window.jckwds_vars.ajax_url,e,function(e){s.unblock(),e.success?(jQuery(document.body).trigger("iconic_wds_reservation_added",e),jQuery("html, body").animate({scrollTop:jQuery(".wds-reservation-table-wrapper").offset().top-50},600),jckwds_vars.settings.reservations_reservations_redirect_url&&(window.location.href=jckwds_vars.settings.reservations_reservations_redirect_url),s.step3.form_open=!1):e.data.message&&alert(e.data.message)}).fail(function(){alert(window.jckwds_vars.strings.reservation_table.cant_book_slot),s.unblock()})},handle_address_changed(e){this.address.country=e.country,this.address.state=e.state,this.address.city=e.city,this.address.postcode=e.postcode},is_earliest_slot(e){var s=this.available_dates.findIndex(e=>e.ymd===this.selected_date);return 0===e&&0===s},block(){jQuery("#wds-reservation-table").block({message:null,overlayCSS:{opacity:.6}})},unblock(){jQuery("#wds-reservation-table").unblock()},open_step(s){for(let e=1;e<=3;e++)e==s?this["step"+e].form_open=!0:this["step"+e].form_open=!1},decode_entities(e){return window.wp&&window.wp.htmlEntities?window.wp.htmlEntities.decodeEntities(e):e}},watch:{selected_shipping_method(){this.step2.caption=!!this.shipping_methods[this.selected_shipping_method]&&this.shipping_methods[this.selected_shipping_method].label}},computed:{selected_date_obj(){return this.available_dates&&this.available_dates.find(e=>e.ymd===this.selected_date)},selected_timeslot_obj(){return this.available_timeslots[this.selected_date]&&this.available_timeslots[this.selected_date].find(e=>e.slot_id===this.selected_slot)},selected_slot_formatted(){let e;return e=this.timeslot_enabled?this.selected_date_obj&&this.selected_timeslot_obj?this.selected_date_obj.formatted+` ${this.formatted_timeslot_seperator} `+this.selected_timeslot_obj.formatted:"":this.selected_date_obj?this.selected_date_obj.formatted:"",this.datetime_required_for_selected_method&&(this.step3.caption=e),e},step3_button_text(){let e=jckwds_vars.strings.reservation_table.reserve;return e=this.selected_slot_formatted?e+" - "+this.selected_slot_formatted:e},total_fees(){return(this.selected_date_obj&&this.selected_date_obj.fee?parseFloat(this.selected_date_obj.fee):0)+(this.selected_timeslot_obj&&this.selected_timeslot_obj.fee.value?parseFloat(this.selected_timeslot_obj.fee.value):0)},total_fees_formatted(){var e=this.total_fees;return e?accounting.formatMoney(e,jckwds_vars.currency):""}}}))}Vue.component("wds-address",{name:"wds-address",data(){return{button_clicked:!1,available_countries:[],locale:{},states:{},fields:{country:"",state:"",postcode:"",city:""},validation:{country:!0,state:!0,postcode:!0,city:!0},strings:{},locale_default:{}}},mounted(){this.strings.select_country=window.jckwds_vars.strings.reservation_table.select_country,this.strings.select_state=window.jckwds_vars.strings.reservation_table.select_state,this.strings.continue=window.jckwds_vars.strings.reservation_table.continue,this.strings.country=window.jckwds_vars.strings.reservation_table.country,this.available_countries=jckwds_vars.available_countries;var e=window.wc_address_i18n_params.locale.replace(/&quot;/g,'"'),e=(this.locale=JSON.parse(e),window.wc_country_select_params.countries.replace(/&quot;/g,'"'));this.states=JSON.parse(e),this.locale_default=jckwds_vars.locale_default,this.fields.country=jckwds_vars.address.country,this.fields.state=jckwds_vars.address.state,this.fields.city=jckwds_vars.address.city,this.fields.postcode=jckwds_vars.address.postcode,this.input_changed()},computed:{selected_locale(){return this.locale[this.fields.country]}},methods:{is_object_empty(e){return 0===Object.keys(e).length},is_postcode_visible(){var e=!(this.selected_locale&&this.selected_locale.postcode&&this.selected_locale.postcode.hidden);return wp.hooks.applyFilters("iconic_wds_reservation_table_postcode_visible","iconic_wds",e)},is_state_visible(){var e=!(this.selected_locale&&this.selected_locale.state&&this.selected_locale.state.hidden);return wp.hooks.applyFilters("iconic_wds_reservation_table_state_visible","iconic_wds",e)},is_city_visible(){var e=!(this.selected_locale&&this.selected_locale.city&&this.selected_locale.city.hidden);return wp.hooks.applyFilters("iconic_wds_reservation_table_city_visible","iconic_wds",e)},country_changed(){this.fields.state="",this.fields.city="",this.fields.postcode="",this.input_changed()},input_changed(){this.$emit("address_changed",this.fields)},validate(){if(this.button_clicked)return this.validation.city=!this.is_city_visible()||!!this.fields.city,this.validation.state=!this.is_state_visible()||!!this.fields.state,this.validation.postcode=!this.is_postcode_visible()||!!this.fields.postcode,this.validation.city&&this.validation.state&&this.validation.postcode},get_label(e){return!(!this.selected_locale&&jQuery.isEmptyObject(this.locale_default))&&(this.selected_locale&&this.selected_locale[e]&&this.selected_locale[e].label?this.selected_locale:this.locale_default)[e].label},handle_btn_click(){this.button_clicked=!0,this.validate()&&this.$emit("button_clicked",this.fields)}},template:`
			<div class="wds-reservation-step-address" v-if="locale">
				<div class="wds-reservation-step-address__inner">
					<div class="wds-reservation-step-address__field" :class="{ 'wds-reservation-step-address__field--error': ! this.validation.country }">
						<label for="wds-reservation-table-address-country">{{strings.country}}</label>
						<select v-model='fields.country' @change="country_changed" id="wds-reservation-table-address-country" class="iconic-wds-dropdown">
							<option value="">{{strings.select_country}}</option>
							<option v-for="(name, code) in available_countries" :value="code" :key="code">{{name}}</option>
						</select>
					</div>
					<div class="wds-reservation-step-address__field" v-show="is_state_visible()"  :class="{ 'wds-reservation-step-address__field--error': ! this.validation.state }">
						<label for="wds-reservation-table-address-state">{{ get_label( 'state' )  }}</label>
						<input
							id="wds-reservation-table-address-state" 
							v-if="'undefined' === typeof states[fields.country]"
							type='text'
							v-model='fields.state'
							@change="validate(); input_changed();"
							>
						<select
							id="wds-reservation-table-address-state"
							class="iconic-wds-dropdown"
							v-if="states[fields.country] && ! is_object_empty( states[fields.country] )"
							v-model='fields.state'
							@change="validate(); input_changed();"
							>
							<option>{{strings.select_state}}</option>
							<option v-for="(state, state_key) in states[fields.country]" :value="state_key" :key="state_key">{{state}}</option>
						</select>
						<input v-if="states[fields.country] && is_object_empty( states[fields.country] )" type='text' @change="input_changed" placeholder="hidden" v-model='fields.state'>
					</div>
					<div class="wds-reservation-step-address__field" v-show="is_city_visible()" :class="{ 'wds-reservation-step-address__field--error': ! this.validation.city }">
						<label for="wds-reservation-table-address-city">{{ get_label( "city" ) }}</label>
						<input type='text' @keyup="validate()" id="wds-reservation-table-address-city"  v-model='fields.city' @change="input_changed">
					</div>
					<div class="wds-reservation-step-address__field" v-show="is_postcode_visible()"  :class="{ 'wds-reservation-step-address__field--error': ! this.validation.postcode }">
						<label for="wds-reservation-table-address-postcode">{{ get_label( "postcode" ) }}</label>
						<input type='text' @keyup="validate()" id="wds-reservation-table-address-postcode" v-model='fields.postcode' @change="input_changed">
					</div>

					</div>
				<button class="wds-reservation-table-button" @click="handle_btn_click">{{strings.continue}}</button>
			</div>
		`}),Vue.component("wds-reservation-date-slider",{name:"wds-reservation-date-slider",components:{slider:vueConciseSlider.slider,slideritem:vueConciseSlider.slideritem},props:["available_dates","initial_selected_date"],data(){return{wrapper_width:0,selected_date:null,right_nav_disabled:!1,left_nav_disabled:!1,slide_styles:{6:{width:"15%","margin-right":"2%"},4:{width:"23%","margin-right":"2%"},3:{width:"31%","margin-right":"3%"}}}},mounted(){this.wrapper_width=jQuery(".wds-reservation-table-wrapper").width(),this.selected_date=this.initial_selected_date,t.$on("open_step",this.slide_to_selected_date)},methods:{select_date(e){this.selected_date=e.ymd,this.$emit("select_date",e)},slide_next(){this.right_nav_disabled||this.$refs.slider.$emit("slideNext")},slide_prev(){this.left_nav_disabled||this.$refs.slider.$emit("slidePre")},on_slide(e){this.left_nav_disabled=0===e.currentPage,this.right_nav_disabled=e.currentPage>=this.available_dates.length-6},slide_to_selected_date(e){3===e&&this.$nextTick(()=>{var e,s=this.available_dates.findIndex(e=>e.ymd===this.selected_date);s<=this.carousel_per_page||(s<(e=this.$refs.slider.data.currentPage)||s>=e+this.carousel_per_page)&&(page=s-this.carousel_per_page+1,this.$refs.slider.$emit("slideTo",page))})}},computed:{carousel_per_page(){return 500<this.wrapper_width?6:400<=this.wrapper_width?4:3}},template:`
			<div class="wds-reservation-table-date-slider">
				<slider 
					:slides-to-scroll="carousel_per_page"
					:currentPage="0"
					ref="slider"
					@slide="on_slide"
					>
					<slideritem v-for="date in available_dates" :key="date.ymd" :style="slide_styles[carousel_per_page]">
						<div class="wds-reservation-table__select-date-date" @click='select_date( date )' :class="{ 'wds-reservation-table__select-date-date--selected': selected_date === date.ymd }" >
							<div class="wds-reservation-table__select-date-date-day">
								{{date.weekday}}
							</div>
							<div class="wds-reservation-table__select-date-date-formatted">
								{{date.header_formatted}}
							</div>
							<div class="wds-reservation-table__select-date-date-fee" v-html="date.fee_formatted"></div>
						</div>
					</slideritem>
				</slider>
				<span v-if="available_dates.length" @click="slide_prev" class='wds-reservation-table-date-slider__nav-next' :class="{ 'wds-reservation-table-date-slider__nav--disabled': left_nav_disabled }">&#xe900;</span>
				<span v-if="available_dates.length" @click="slide_next" class='wds-reservation-table-date-slider__nav-prev' :class="{ 'wds-reservation-table-date-slider__nav--disabled': right_nav_disabled }">&#xe902;</span>
			</div>
		`}),e(),jQuery(document.body).on("iconic_wds_init_reservation_table",e)}}),(o=>{var c={cache(){c.cache.vars={tooltip:".iconic-wds-tooltip",arrow:".iconic-wds-tooltip__arrow",anchor:".iconic-wds-date--tooltip"}},on_ready(){c.cache(),0===o(".iconic-wds-tooltip").length&&(o("body").append('<div class="iconic-wds-tooltip"><div class="iconic-wds-tooltip__inner_wrap"></div><div class="iconic-wds-tooltip__arrow"></div></div>'),o(".iconic-wds-tooltip").hide(),o(".iconic-wds-tooltip").addClass("iconic-wds-tooltip--theme-"+jckwds_vars.settings.datesettings_datesettings_setup_uitheme)),o(window).resize(c.on_resize);var e=c.debounce(c.handle_mouseenter,200),s=c.debounce(c.handle_mouseleave,200);jckwds_vars.is_mobile?(c.mobile_click_handler(),o(window).scroll(c.handle_mouseleave),o(window).on("resize_threshold",c.handle_mouseleave)):(o(document.body).on("mouseenter",c.cache.vars.anchor,e),o(document.body).on("mouseleave",c.cache.vars.anchor,s),o(window).scroll(c.handle_mouseleave).resize(c.handle_mouseleave))},handle_mouseenter(){var e,s,t,d,i=o(this).attr("aria-label"),a=o(c.cache.vars.tooltip);i&&(a.find(".iconic-wds-tooltip__inner_wrap").html(i),a.css({left:"",right:""}),i=a.find(c.cache.vars.arrow),s=a.outerWidth(!0),t=(t=(e=(d=o(this).get(0).getBoundingClientRect()).left+d.width/2)-s/2)<0?0:t,o(window).width()<s+t?a.css({left:"",right:0}):a.css({left:t,right:""}),s=a.outerHeight(!0),t=d.top-s,a.css("top",t).show().addClass("iconic-wds-tooltip--animate-opacity iconic-wds-tooltip--animate-top iconic-wds-tooltip--active"),d=a.offset(),i.css("left",e-d.left))},handle_mouseleave(){c.cache.vars||c.cache(),o(c.cache.vars.tooltip).removeClass("iconic-wds-tooltip--animate-top iconic-wds-tooltip--animate-opacity iconic-wds-tooltip--active")},mobile_click_handler(){document.addEventListener("click",function(e){var s,t=document.querySelectorAll(c.cache.vars.anchor),d=e.composedPath();let i=!1;for(s in t){var a=t[s];if(d.includes(a)){i=a;break}}i?c.handle_mouseenter.call(i):c.handle_mouseleave()})},debounce(d,i,a){let o;return function(){let e=this,s=arguments;var t=a&&!o;clearTimeout(o),o=setTimeout(function(){o=null,a||d.apply(e,s)},i),t&&d.apply(e,s)}},remove_title_attribute(e,s){window.setTimeout(function(){o(".iconic-wds-datepicker .iconic-wds-date").each(function(){var e=o(this).attr("title");o(this).removeAttr("title"),o(this).attr("aria-label",e)})},100)}};o(document.body).on("iconic_wds_datepicker_before_show iconic_wds_datepicker_on_change_month_year",c.remove_title_attribute),o(document.body).on("iconic_wds_selected_date_changed",c.handle_mouseleave),o(document.body).on("iconic_wds_init_tooltip",c.on_ready)})(jQuery),((d,e)=>{var t={cache(){t.els={},t.els.check_button=d("#jckwds-check-button"),t.els.pay_button=d("#jckwds-save-button"),t.els.date_field=d("#jckwds-delivery-date"),t.els.time_field=d("#jckwds-delivery-time"),t.els.popup_open=d(".wds-edit-slot__action-btn"),t.els.popup_close=d(".wds-edit-slot-popup__cancel")},init(){d("#jckwds-submit-button-wrapper").length&&(t.cache(),jckwds.refresh_datepicker(jckwds_vars.bookable_dates),t.handle_timeslot_changes(),t.handle_check_button_click(),t.handle_pay_button_click(),t.handle_popup(),t.toggle_submit_button_status(),d(".wds-edit-slot").hasClass("wds-edit-slot--thankyou")&&d(".wds-edit-slot").hasClass("wds-edit-slot--empty")&&t.open_popup(),d(e.body).trigger("iconic_wds_edit_timeslot_init"))},toggle_submit_button_status(){var e=t.get_submit_button_status();t.els.check_button.attr("disabled",!e)},get_submit_button_status(){var e="1"===jckwds_vars.settings.timesettings_timesettings_setup_enable;let s=t.els.date_field.val();return s=e?t.els.time_field.val():s},handle_popup(){t.els.popup_open.click(function(e){t.open_popup()}),t.els.popup_close.click(function(e){e.preventDefault(),t.close_popup()})},open_popup(){d(e.body).css("overflow","hidden"),d(".wds-edit-slot-popup").removeClass("wds-edit-slot-popup--hidden"),d("#jckwds-delivery-time option").length<=1&&t.els.date_field.val()&&window.jckwds.refresh_timeslots()},close_popup(){d(e.body).css("overflow","scroll"),d(".wds-edit-slot-popup").addClass("wds-edit-slot-popup--hidden")},handle_timeslot_changes(){d(e).on("change","#jckwds-delivery-date, #jckwds-delivery-time",function(){d(".jckwds-fees-update-summary").html(""),t.els.check_button.show(),t.els.pay_button.hide(),t.toggle_submit_button_status()})},handle_check_button_click(){t.els.check_button.click(function(){t.check_fee_difference()})},check_fee_difference(){let e={action:"iconic_wds_check_fee_difference",security:jckwds_vars.ajax_nonce,context:"frontend"};d("#jckwds-fields").find("input, select").each(function(){e[d(this).attr("name")]=d(this).val()}),jckwds.block_checkout(),d.post(jckwds_vars.ajax_url,e).done(function(e){e&&e.success&&e.data?(e.data.slot_updated?(t.close_popup(),t.show_notice(e.data.success_notice),d(".wds-edit-slot__details-timeslot").text(e.data.new_timeslot)):e.data.html&&(d(".wds-edit-slot-popup__msg").remove(),d(e.data.html).insertBefore("#jckwds-check-button")),e?.data?.show_pay_button&&(t.els.check_button.hide(),t.els.pay_button.show())):(t.show_notice(jckwds_vars.strings.cant_save_timeslot,"error"),t.close_popup())}).always(function(){jckwds.unblock_checkout()})},handle_pay_button_click(){t.els.pay_button.click(function(){let e={action:"iconic_wds_create_sub_order",security:jckwds_vars.ajax_nonce};d("#jckwds-fields").find("input, select").each(function(){e[d(this).attr("name")]=d(this).val()}),jckwds.block_checkout(),d.post(jckwds_vars.ajax_url,e).done(function(e){e?.data?.payment_url&&window.open(e.data.payment_url)}).always(function(){jckwds.unblock_checkout()})})},show_notice(e,s="success",t=!0){s=`<div class='wds-edit-slot-popup__msg wds-edit-slot-popup__msg--${s}'>${e}</div>`;t&&d(".wds-edit-slot-popup__msg").remove(),d(s).insertBefore(".wds-edit-slot__wrap"),d("html, body").animate({scrollTop:d(".wds-edit-slot__wrap").offset().top-100},200)}};window.jckwds_update=t,d(window).on("load",t.init)})(jQuery,document);